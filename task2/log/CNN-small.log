cuda memory allocated: 6212096
> n_trainable_params: 361805, n_nontrainable_params: 1190700
> training arguments:
>>> model_name: CNN
>>> dataset: small
>>> optimizer: <class 'torch.optim.adamw.AdamW'>
>>> initializer: <function kaiming_uniform_ at 0x000002B620D3BF40>
>>> lr: 0.001
>>> dropout: 0.1
>>> l2reg: 0.01
>>> epochs: 10
>>> batch_size: 50
>>> log_step: 10
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> kernel_sizes: [3, 4, 5]
>>> kernel_num: 100
>>> max_seq_len: 85
>>> num_classes: 5
>>> device: cuda
>>> seed: 42
>>> valset_ratio: 0.2
>>> model_class: <class 'models.cnn.CNN'>
>>> dataset_file: {'train': 'dataset/train_small.csv', 'test': 'dataset/test.csv'}
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.3104, acc: 0.5420
loss: 1.2863, acc: 0.5450
loss: 1.2419, acc: 0.5573
loss: 1.2273, acc: 0.5615
loss: 1.1950, acc: 0.5732
loss: 1.1773, acc: 0.5763
loss: 1.1490, acc: 0.5851
loss: 1.1406, acc: 0.5840
loss: 1.1273, acc: 0.5882
loss: 1.1141, acc: 0.5920
loss: 1.1014, acc: 0.5956
loss: 1.0875, acc: 0.6023
loss: 1.0824, acc: 0.6026
loss: 1.0675, acc: 0.6074
loss: 1.0590, acc: 0.6100
loss: 1.0522, acc: 0.6116
loss: 1.0406, acc: 0.6162
loss: 1.0301, acc: 0.6202
loss: 1.0260, acc: 0.6209
loss: 1.0164, acc: 0.6251
loss: 1.0091, acc: 0.6269
loss: 1.0018, acc: 0.6286
loss: 0.9934, acc: 0.6317
loss: 0.9885, acc: 0.6332
loss: 0.9843, acc: 0.6340
> val_acc: 0.6693, val_f1: 0.4794
>> saved: state_dict/CNN_small_val_acc_0.6693
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.7518, acc: 0.7320
loss: 0.7222, acc: 0.7400
loss: 0.7216, acc: 0.7373
loss: 0.7244, acc: 0.7315
loss: 0.7225, acc: 0.7304
loss: 0.7225, acc: 0.7287
loss: 0.7249, acc: 0.7277
loss: 0.7280, acc: 0.7272
loss: 0.7247, acc: 0.7258
loss: 0.7217, acc: 0.7240
loss: 0.7166, acc: 0.7247
loss: 0.7179, acc: 0.7233
loss: 0.7169, acc: 0.7232
loss: 0.7192, acc: 0.7219
loss: 0.7228, acc: 0.7201
loss: 0.7259, acc: 0.7188
loss: 0.7255, acc: 0.7186
loss: 0.7274, acc: 0.7179
loss: 0.7263, acc: 0.7181
loss: 0.7289, acc: 0.7177
loss: 0.7302, acc: 0.7166
loss: 0.7298, acc: 0.7167
loss: 0.7307, acc: 0.7159
loss: 0.7324, acc: 0.7153
loss: 0.7341, acc: 0.7133
> val_acc: 0.6825, val_f1: 0.5064
>> saved: state_dict/CNN_small_val_acc_0.6825
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.5482, acc: 0.8020
loss: 0.5866, acc: 0.7790
loss: 0.5996, acc: 0.7700
loss: 0.6084, acc: 0.7655
loss: 0.6120, acc: 0.7616
loss: 0.6133, acc: 0.7600
loss: 0.6108, acc: 0.7623
loss: 0.6214, acc: 0.7562
loss: 0.6224, acc: 0.7571
loss: 0.6247, acc: 0.7572
loss: 0.6259, acc: 0.7576
loss: 0.6288, acc: 0.7568
loss: 0.6336, acc: 0.7520
loss: 0.6334, acc: 0.7523
loss: 0.6354, acc: 0.7511
loss: 0.6351, acc: 0.7515
loss: 0.6347, acc: 0.7531
loss: 0.6369, acc: 0.7526
loss: 0.6407, acc: 0.7501
loss: 0.6417, acc: 0.7493
loss: 0.6411, acc: 0.7493
loss: 0.6447, acc: 0.7485
loss: 0.6478, acc: 0.7466
loss: 0.6473, acc: 0.7468
loss: 0.6510, acc: 0.7447
> val_acc: 0.6700, val_f1: 0.5175
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.5566, acc: 0.7840
loss: 0.5415, acc: 0.7950
loss: 0.5503, acc: 0.7947
loss: 0.5510, acc: 0.7925
loss: 0.5655, acc: 0.7832
loss: 0.5686, acc: 0.7800
loss: 0.5712, acc: 0.7789
loss: 0.5716, acc: 0.7772
loss: 0.5726, acc: 0.7758
loss: 0.5690, acc: 0.7766
loss: 0.5681, acc: 0.7755
loss: 0.5645, acc: 0.7783
loss: 0.5652, acc: 0.7782
loss: 0.5710, acc: 0.7744
loss: 0.5722, acc: 0.7732
loss: 0.5726, acc: 0.7738
loss: 0.5770, acc: 0.7716
loss: 0.5795, acc: 0.7697
loss: 0.5810, acc: 0.7686
loss: 0.5842, acc: 0.7675
loss: 0.5866, acc: 0.7669
loss: 0.5875, acc: 0.7669
loss: 0.5889, acc: 0.7659
loss: 0.5894, acc: 0.7666
loss: 0.5932, acc: 0.7643
> val_acc: 0.6841, val_f1: 0.5406
>> saved: state_dict/CNN_small_val_acc_0.6841
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.4484, acc: 0.8340
loss: 0.4739, acc: 0.8240
loss: 0.4905, acc: 0.8180
loss: 0.5004, acc: 0.8080
loss: 0.5037, acc: 0.8072
loss: 0.5010, acc: 0.8093
loss: 0.5038, acc: 0.8066
loss: 0.5056, acc: 0.8073
loss: 0.5110, acc: 0.8049
loss: 0.5145, acc: 0.8038
loss: 0.5246, acc: 0.7978
loss: 0.5263, acc: 0.7953
loss: 0.5221, acc: 0.7968
loss: 0.5292, acc: 0.7923
loss: 0.5303, acc: 0.7927
loss: 0.5300, acc: 0.7930
loss: 0.5327, acc: 0.7920
loss: 0.5369, acc: 0.7903
loss: 0.5371, acc: 0.7908
loss: 0.5426, acc: 0.7887
loss: 0.5467, acc: 0.7862
loss: 0.5494, acc: 0.7844
loss: 0.5525, acc: 0.7832
loss: 0.5543, acc: 0.7828
loss: 0.5558, acc: 0.7811
> val_acc: 0.6854, val_f1: 0.5046
>> saved: state_dict/CNN_small_val_acc_0.6854
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.4821, acc: 0.7860
loss: 0.4724, acc: 0.8040
loss: 0.4516, acc: 0.8213
loss: 0.4537, acc: 0.8210
loss: 0.4615, acc: 0.8180
loss: 0.4712, acc: 0.8103
loss: 0.4722, acc: 0.8091
loss: 0.4793, acc: 0.8087
loss: 0.4809, acc: 0.8093
loss: 0.4833, acc: 0.8094
loss: 0.4843, acc: 0.8098
loss: 0.4812, acc: 0.8107
loss: 0.4852, acc: 0.8089
loss: 0.4907, acc: 0.8076
loss: 0.4925, acc: 0.8076
loss: 0.4965, acc: 0.8054
loss: 0.5008, acc: 0.8039
loss: 0.5036, acc: 0.8028
loss: 0.5051, acc: 0.8016
loss: 0.5080, acc: 0.7997
loss: 0.5117, acc: 0.7976
loss: 0.5138, acc: 0.7970
loss: 0.5168, acc: 0.7958
loss: 0.5203, acc: 0.7957
loss: 0.5229, acc: 0.7947
> val_acc: 0.6751, val_f1: 0.5130
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.4062, acc: 0.8480
loss: 0.4156, acc: 0.8410
loss: 0.4316, acc: 0.8267
loss: 0.4289, acc: 0.8330
loss: 0.4349, acc: 0.8332
loss: 0.4260, acc: 0.8353
loss: 0.4353, acc: 0.8300
loss: 0.4383, acc: 0.8303
loss: 0.4392, acc: 0.8311
loss: 0.4408, acc: 0.8314
loss: 0.4428, acc: 0.8305
loss: 0.4456, acc: 0.8283
loss: 0.4491, acc: 0.8282
loss: 0.4496, acc: 0.8274
loss: 0.4529, acc: 0.8263
loss: 0.4533, acc: 0.8261
loss: 0.4566, acc: 0.8242
loss: 0.4608, acc: 0.8216
loss: 0.4634, acc: 0.8212
loss: 0.4675, acc: 0.8188
loss: 0.4682, acc: 0.8190
loss: 0.4718, acc: 0.8162
loss: 0.4724, acc: 0.8146
loss: 0.4738, acc: 0.8137
loss: 0.4792, acc: 0.8119
> val_acc: 0.6741, val_f1: 0.5167
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.3392, acc: 0.8700
loss: 0.3757, acc: 0.8660
loss: 0.3921, acc: 0.8593
loss: 0.3986, acc: 0.8550
loss: 0.4114, acc: 0.8488
loss: 0.4134, acc: 0.8467
loss: 0.4176, acc: 0.8457
loss: 0.4293, acc: 0.8387
loss: 0.4266, acc: 0.8407
loss: 0.4266, acc: 0.8396
loss: 0.4309, acc: 0.8369
loss: 0.4336, acc: 0.8368
loss: 0.4342, acc: 0.8349
loss: 0.4380, acc: 0.8327
loss: 0.4402, acc: 0.8315
loss: 0.4393, acc: 0.8336
loss: 0.4414, acc: 0.8329
loss: 0.4433, acc: 0.8324
loss: 0.4465, acc: 0.8306
loss: 0.4481, acc: 0.8300
loss: 0.4499, acc: 0.8286
loss: 0.4527, acc: 0.8278
loss: 0.4553, acc: 0.8263
loss: 0.4574, acc: 0.8260
loss: 0.4615, acc: 0.8239
> val_acc: 0.6741, val_f1: 0.5350
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.4368, acc: 0.8420
loss: 0.4073, acc: 0.8490
loss: 0.4027, acc: 0.8533
loss: 0.4016, acc: 0.8505
loss: 0.3977, acc: 0.8528
loss: 0.4069, acc: 0.8477
loss: 0.4020, acc: 0.8474
loss: 0.4030, acc: 0.8480
loss: 0.4084, acc: 0.8471
loss: 0.4097, acc: 0.8460
loss: 0.4116, acc: 0.8455
loss: 0.4086, acc: 0.8452
loss: 0.4141, acc: 0.8431
loss: 0.4183, acc: 0.8426
loss: 0.4166, acc: 0.8427
loss: 0.4177, acc: 0.8421
loss: 0.4216, acc: 0.8409
loss: 0.4209, acc: 0.8411
loss: 0.4215, acc: 0.8403
loss: 0.4227, acc: 0.8405
loss: 0.4278, acc: 0.8382
loss: 0.4331, acc: 0.8355
loss: 0.4341, acc: 0.8349
loss: 0.4354, acc: 0.8340
loss: 0.4375, acc: 0.8327
> val_acc: 0.6793, val_f1: 0.5226
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.4244, acc: 0.8560
loss: 0.4034, acc: 0.8560
loss: 0.3992, acc: 0.8547
loss: 0.3996, acc: 0.8535
loss: 0.3885, acc: 0.8584
loss: 0.3915, acc: 0.8573
loss: 0.3882, acc: 0.8566
loss: 0.3966, acc: 0.8562
loss: 0.3990, acc: 0.8556
loss: 0.4010, acc: 0.8538
loss: 0.3975, acc: 0.8549
loss: 0.3966, acc: 0.8550
loss: 0.3982, acc: 0.8540
loss: 0.4009, acc: 0.8519
loss: 0.4079, acc: 0.8496
loss: 0.4094, acc: 0.8492
loss: 0.4129, acc: 0.8475
loss: 0.4140, acc: 0.8456
loss: 0.4142, acc: 0.8455
loss: 0.4145, acc: 0.8450
loss: 0.4141, acc: 0.8451
loss: 0.4153, acc: 0.8445
loss: 0.4142, acc: 0.8452
loss: 0.4180, acc: 0.8434
loss: 0.4184, acc: 0.8441
> val_acc: 0.6722, val_f1: 0.5350
